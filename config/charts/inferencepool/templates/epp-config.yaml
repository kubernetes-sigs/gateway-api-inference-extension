apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "gateway-api-inference-extension.name" . }}
  namespace: {{ .Release.Namespace }}
data:
  default-plugins.yaml: |
    apiVersion: inference.networking.x-k8s.io/v1alpha1
    kind: EndpointPickerConfig
    plugins:
    - type: queue-scorer
    - type: kv-cache-utilization-scorer
    - type: lora-affinity-scorer
    - type: prefix-cache-scorer
    - type: max-score-picker
    - type: single-profile-handler
    schedulingProfiles:
    - name: default
      plugins:
      - pluginRef: queue-scorer
      - pluginRef: kv-cache-utilization-scorer
      - pluginRef: prefix-cache-scorer
      - pluginRef: max-score-picker
  {{- if (hasKey .Values.inferenceExtension "pluginsCustomConfig") }}
  {{- .Values.inferenceExtension.pluginsCustomConfig | toYaml | nindent 2 }}
  {{- end }}
  
